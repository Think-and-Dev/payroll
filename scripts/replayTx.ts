import {TransactionRequest, BlockTag} from '@ethersproject/abstract-provider';
import {ethers} from 'hardhat';

async function functionCall(tx: TransactionRequest, blockNumber: BlockTag) {
  const archiveProvider = new ethers.providers.StaticJsonRpcProvider(
    'https://speedy-nodes-nyc.moralis.io/59763aa3a28a9cb1ae270998/bsc/mainnet/archive'
  );
  // TODO blockTag is not being taken into account, it gives the same value even if using block number 1
  archiveProvider.call(tx, blockNumber);
}

// https://bscscan.com/tx/0xda8a2a8d8f1032b9ea0c26d31b54141c79ea0b77dace5c28d8e972cb2431b7af
const tx: TransactionRequest = {
  data: '0x9272148200000000000000000000000055d398326f99059ff775485246999027b3197955000000000000000000000000000000000000000000000016c4abbebea0100000000000000000000000000000000000000000000000000000000000006297c2d600000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000280000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000005fbe3e77abd91a000000000000000000000000000000000000000000000002d89577d7d40200000000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000000200000000000000000000000055d398326f99059ff775485246999027b31979550000000000000000000000002170ed0880ac9a755fd29b2688956bd959f933f800000000000000000000000000000000000000000000000815db1363880ff06200000000000000000000000000000000000000000000000889c067877c0600000000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000000200000000000000000000000055d398326f99059ff775485246999027b31979550000000000000000000000008ac76a51cc950d9822d68b83fe1ad97b32cd580d00000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000002600000000000000000000000002170ed0880ac9a755fd29b2688956bd959f933f8000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d9cf95b08b87a8fe49da81c93f58b80256be56390000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000005fbe3e77abd91a0000000000000000000000008ac76a51cc950d9822d68b83fe1ad97b32cd580d000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000d9cf95b08b87a8fe49da81c93f58b80256be563900000000000000000000000062c751f207517c7f0f4f86720be4e4368f519d670000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000002b1f3b1212d5aa57600000000000000000000000000000000000000000000000563e762425ab54aec00000000000000000000000055d398326f99059ff775485246999027b3197955000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000000200000000000000000000000092f2c7902ee8a17b94b3edb29d0351a6a1bd572900000000000000000000000082732eca78474a772799b341100098f05464c40100000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000056bc75e2d631000000000000000000000000000000000000000000000000000056bc75e2d63100000',
  from: '0xf46a3e7007d55ae6ee4e3bd8d80313537e54e0c5',
  to: '0xe2ebfc705d473c3ddd52cb49af0bde3132e8831e',
  gasLimit: 517294,
};
const blockNumber = 18317009;
functionCall(tx, blockNumber);
